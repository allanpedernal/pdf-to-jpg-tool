<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Primary SEO Meta Tags -->
  <title>PDF to JPG Converter - Free Online PDF to Image Converter Tool</title>
  <meta name="title" content="PDF to JPG Converter - Free Online PDF to Image Converter Tool">
  <meta name="description" content="Convert PDF to JPG online for free. Fast, high-quality PDF to image converter for multi-page PDFs. No software required. Convert PDF pages to JPEG images instantly in your browser.">
  <meta name="keywords" content="pdf to jpg, pdf to image, pdf converter, pdf to jpeg, convert pdf to jpg, pdf to jpg online, free pdf converter, pdf to image converter, pdf pages to images, pdf to jpg converter online">
  <meta name="author" content="PDF Tools">
  <meta name="robots" content="index, follow">
  <meta name="language" content="English">
  <meta name="revisit-after" content="7 days">
  <meta name="theme-color" content="#0f172a">
  
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 20px rgba(59, 130, 246, 0.4); }
      50% { box-shadow: 0 0 30px rgba(59, 130, 246, 0.7); }
    }
    @keyframes slide-in {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes bounce-in {
      0% { transform: scale(0.8); opacity: 0; }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); opacity: 1; }
    }
    @keyframes spin-slow {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .animate-pulse-glow {
      animation: pulse-glow 2s ease-in-out infinite;
    }
    .animate-slide-in {
      animation: slide-in 0.5s ease-out;
    }
    .animate-bounce-in {
      animation: bounce-in 0.6s ease-out;
    }
    .animate-spin-slow {
      animation: spin-slow 3s linear infinite;
    }
    .progress-bar {
      transition: width 0.3s ease-out;
    }
    /* Sidebar width for ads */
    .lg\:w-160 {
      width: 160px;
    }
    @media (min-width: 1024px) {
      .lg\:w-160 {
        width: 160px;
      }
    }
  </style>

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://www.pdf-to-jpg-tool.com/">
  <meta property="og:title" content="PDF to JPG Converter - Free Online PDF to Image Converter Tool">
  <meta property="og:description" content="Convert PDF to JPG online for free. Fast, high-quality PDF to image converter for multi-page PDFs. No software required.">
  <meta property="og:image" content="https://www.pdf-to-jpg-tool.com/preview.jpg">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:site_name" content="PDF Tools">
  <meta property="og:locale" content="en_US">
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://www.pdf-to-jpg-tool.com/">
  <meta name="twitter:title" content="PDF to JPG Converter - Free Online PDF to Image Converter Tool">
  <meta name="twitter:description" content="Convert PDF to JPG online for free. Fast, high-quality PDF to image converter for multi-page PDFs. No software required.">
  <meta name="twitter:image" content="https://www.pdf-to-jpg-tool.com/preview.jpg">
  <meta name="twitter:creator" content="@allanpedernal">
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://www.pdf-to-jpg-tool.com/">
  
  <!-- Structured Data (JSON-LD) for SEO -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "PDF to JPG Converter",
    "description": "Free online tool to convert PDF files to JPG images. Convert multi-page PDFs to high-quality JPEG images instantly in your browser.",
    "url": "https://www.pdf-to-jpg-tool.com/",
    "applicationCategory": "UtilityApplication",
    "operatingSystem": "Any",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "aggregateRating": {
      "@type": "AggregateRating",
      "ratingValue": "4.8",
      "ratingCount": "1250"
    },
    "featureList": [
      "Convert PDF to JPG",
      "Multi-page PDF support",
      "High-quality image output",
      "No file upload required",
      "100% free and secure",
      "Works in browser",
      "No software installation needed"
    ],
    "browserRequirements": "Requires JavaScript. Requires HTML5.",
    "softwareVersion": "1.0",
    "releaseNotes": "Free PDF to JPG converter tool",
    "screenshot": "https://www.pdf-to-jpg-tool.com/preview.jpg"
  }
  </script>
  
  <!-- Additional Structured Data for HowTo -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "How to Convert PDF to JPG Online",
    "description": "Step-by-step guide to convert PDF files to JPG images using our free online converter tool.",
    "step": [
      {
        "@type": "HowToStep",
        "name": "Select PDF File",
        "text": "Drag and drop your PDF file or click to browse and select a PDF file from your computer.",
        "position": 1
      },
      {
        "@type": "HowToStep",
        "name": "Adjust Settings",
        "text": "Set JPEG quality (0.1-1.0) and scale (0.5-3.0) according to your needs. Higher quality and scale produce larger but better images.",
        "position": 2
      },
      {
        "@type": "HowToStep",
        "name": "Convert PDF",
        "text": "Click the 'Convert PDF to JPG' button to start the conversion process.",
        "position": 3
      },
      {
        "@type": "HowToStep",
        "name": "Download Images",
        "text": "Wait for the conversion to complete. All JPG images will be automatically downloaded as a ZIP file.",
        "position": 4
      }
    ]
  }
  </script>
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-G1CV3K3BXS"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-G1CV3K3BXS', {
      'page_title': 'PDF to JPG Converter',
      'page_location': window.location.href
    });
    
    // Track conversion event
    function trackConversion(pages) {
      gtag('event', 'pdf_conversion', {
        'event_category': 'PDF Tools',
        'event_label': 'PDF to JPG',
        'value': pages,
        'pages_converted': pages
      });
    }
  </script>
  
  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2042221703015293"
     crossorigin="anonymous"></script>

</head>
<body class="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-slate-50 min-h-screen" style="background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);">

  <!-- Main Container with Sidebars -->
  <div class="flex flex-col lg:flex-row w-full min-h-screen">
    
    <!-- Left Sidebar Ad (Desktop only) -->
    <aside class="hidden lg:block lg:flex-shrink-0 lg:sticky lg:self-start" style="width: 160px; top: 20px;">
      <div class="w-full bg-gray-700/50 p-4 mt-4 rounded-lg mx-2 sticky top-4">
        <!-- Google AdSense Left Sidebar -->
        <ins class="adsbygoogle"
             style="display:block; text-align:center;"
             data-ad-layout="in-article"
             data-ad-format="fluid"
             data-ad-client="ca-pub-2042221703015293"
             data-ad-slot="5198028961"></ins>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 w-full max-w-4xl mx-auto px-6 flex flex-col items-center animate-slide-in">
    <div class="text-center mb-8">
      <div class="inline-block mb-4">
        <svg class="w-16 h-16 text-blue-400 animate-bounce-in" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="color: #60a5fa;">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 9h6M9 13h6M9 17h4"/>
        </svg>
      </div>
      <h1 class="text-4xl md:text-5xl font-bold mb-3 text-center bg-gradient-to-r from-blue-400 via-cyan-400 to-blue-500 bg-clip-text text-transparent" style="color: #60a5fa;">
        PDF ‚Üí JPG Converter
      </h1>
      <p class="text-slate-200 text-lg mb-2 font-medium">Convert PDF to JPG instantly in your browser</p>
      <p class="text-slate-400 text-sm">Free ‚Ä¢ Fast ‚Ä¢ No Upload Required ‚Ä¢ 100% Secure</p>
    </div>

    <!-- Drag & Drop Area -->
    <label class="w-full border-2 border-dashed border-slate-600 rounded-xl p-12 flex flex-col items-center justify-center cursor-pointer hover:border-blue-400 hover:bg-slate-800/60 transition-all duration-300 mb-6 bg-slate-800/40 backdrop-blur-sm shadow-lg hover:shadow-blue-500/30 group transform" id="dropzone" style="border-color: #475569;">
      <div class="mb-4 relative">
        <svg class="w-16 h-16 text-blue-400 group-hover:scale-110 transition-transform duration-300" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" style="color: #60a5fa;">
          <path stroke-linecap="round" stroke-linejoin="round" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
        </svg>
        <div class="absolute inset-0 flex items-center justify-center">
          <svg class="w-8 h-8 text-blue-300 opacity-0 group-hover:opacity-100 transition-opacity duration-300 animate-spin-slow" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="color: #93c5fd;">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M12 12V4m0 0l-3 3m3-3l3 3"/>
          </svg>
        </div>
      </div>
      <span id="dropLabel" class="text-slate-200 font-semibold text-lg mb-2 group-hover:text-blue-400 transition-colors" style="color: #e2e8f0;">Drag & drop your PDF here</span>
      <span class="text-slate-400 text-sm" style="color: #94a3b8;">or click to browse files</span>
      <input type="file" id="file" class="hidden" accept="application/pdf" />
    </label>

    <!-- Controls -->
    <div class="flex flex-wrap gap-4 w-full mb-6 justify-center items-end">
      <div class="bg-slate-800/60 backdrop-blur-sm rounded-xl p-4 shadow-lg" style="background-color: rgba(30, 41, 59, 0.7);">
        <label class="block text-slate-200 text-sm mb-2 font-medium flex items-center gap-2" style="color: #e2e8f0;">
          <svg class="w-4 h-4 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="color: #60a5fa;">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
          </svg>
          JPEG Quality
        </label>
        <input type="number" id="quality" min="0.1" max="1" step="0.1" value="0.85" class="px-4 py-2 rounded-lg bg-slate-700 border border-slate-600 text-slate-50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all w-32" style="background-color: #334155; border-color: #475569; color: #f8fafc;">
        <span class="text-xs text-slate-400 mt-1 block" style="color: #94a3b8;">0.1 (low) - 1.0 (high)</span>
      </div>
      <div class="bg-slate-800/60 backdrop-blur-sm rounded-xl p-4 shadow-lg" style="background-color: rgba(30, 41, 59, 0.7);">
        <label class="block text-slate-200 text-sm mb-2 font-medium flex items-center gap-2" style="color: #e2e8f0;">
          <svg class="w-4 h-4 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="color: #60a5fa;">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v6m3-3H7"/>
          </svg>
          Scale
        </label>
        <input type="number" id="scale" min="0.5" max="3" step="0.1" value="1.6" class="px-4 py-2 rounded-lg bg-slate-700 border border-slate-600 text-slate-50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all w-32" style="background-color: #334155; border-color: #475569; color: #f8fafc;">
        <span class="text-xs text-slate-400 mt-1 block" style="color: #94a3b8;">1.0 = original size</span>
      </div>
      <div class="flex flex-col gap-2">
        <button id="start" class="px-8 py-3 bg-gradient-to-r from-blue-500 to-cyan-500 text-white font-bold rounded-xl hover:from-blue-600 hover:to-cyan-600 transition-all duration-300 shadow-lg hover:shadow-blue-500/50 transform hover:scale-105 flex items-center gap-2" style="background: linear-gradient(to right, #3b82f6, #06b6d4); color: #ffffff; box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.3);">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
          </svg>
          Convert PDF to JPG
        </button>
        <button id="cancel" class="px-6 py-2 border-2 border-slate-600 rounded-xl text-slate-300 hover:border-orange-400 hover:text-orange-400 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed" style="border-color: #475569; color: #cbd5e1;" disabled>
          Cancel
        </button>
      </div>
    </div>

    <!-- Progress -->
    <div class="w-full bg-slate-800/60 backdrop-blur-sm rounded-xl p-6 shadow-lg mb-6" style="background-color: rgba(30, 41, 59, 0.7);">
      <div class="flex items-center justify-between mb-3">
        <span class="text-slate-200 font-medium flex items-center gap-2" style="color: #e2e8f0;">
          <svg class="w-5 h-5 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="color: #60a5fa;">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
          </svg>
          Progress
        </span>
        <span id="stats" class="text-sm text-slate-300 font-medium" style="color: #cbd5e1;">No file selected</span>
      </div>
      <div class="w-full h-4 bg-slate-700 rounded-full overflow-hidden shadow-inner" style="background-color: #334155;">
        <div id="bar" class="h-full bg-gradient-to-r from-blue-500 via-cyan-400 to-blue-500 w-0 progress-bar rounded-full relative" style="background: linear-gradient(to right, #3b82f6, #22d3ee, #3b82f6);">
          <div class="absolute inset-0 bg-white/30 animate-pulse"></div>
        </div>
      </div>
      <p id="log" class="text-sm text-slate-200 min-h-[32px] text-center mt-4 font-medium flex items-center justify-center gap-2" style="color: #e2e8f0;">
        <span class="inline-block">‚ú®</span>
        <span>Ready to convert your PDF files</span>
      </p>
    </div>

  </main>

    <!-- Right Sidebar Ad (Desktop only) -->
    <aside class="hidden lg:block lg:flex-shrink-0 lg:sticky lg:self-start" style="width: 160px; top: 20px;">
      <div class="w-full bg-gray-700/50 p-4 mt-4 rounded-lg mx-2 sticky top-4">
        <!-- Google AdSense Right Sidebar -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-format="autorelaxed"
             data-ad-client="ca-pub-2042221703015293"
             data-ad-slot="2609300742"></ins>
      </div>
    </aside>
    
  </div>

  <!-- Bottom Ad Placeholder -->
  <div class="w-full bg-gray-700 text-center py-4 mt-auto rounded-t-md">
    <!-- Google AdSense Bottom Banner -->
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-2042221703015293"
         data-ad-slot="9174709096"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
  </div>

  <!-- Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  
  <!-- PDF.js library - using cdnjs for better reliability -->
  <script>
  // Wait for both DOM and PDF.js to be ready
  let pdfjsReady = false;
  
  // Initialize PDF.js worker when library loads
  function initPDFJS(workerSrc) {
    if (typeof pdfjsLib !== 'undefined') {
      // Set worker source
      pdfjsLib.GlobalWorkerOptions.workerSrc = workerSrc || 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
      pdfjsReady = true;
      console.log('PDF.js initialized successfully');
      updateReadyState();
      return true;
    }
    return false;
  }

  function updateReadyState() {
    const logEl = document.getElementById('log');
    if (logEl && pdfjsReady) {
      logEl.innerHTML = '<span class="inline-block animate-bounce">‚ú®</span> <span>Ready to convert your PDF files</span>';
      logEl.style.color = '#60a5fa'; // blue-400
    }
  }

  // Fallback loading function
  function loadPDFJSFallback() {
    console.log('Trying fallback CDN for PDF.js...');
    const pdfjsScript = document.createElement('script');
    pdfjsScript.src = 'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js';
    pdfjsScript.onload = function() {
      if (initPDFJS('https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.worker.min.js')) {
        console.log('PDF.js loaded from jsDelivr CDN');
      } else {
        tryUnpkgFallback();
      }
    };
    pdfjsScript.onerror = function() {
      console.error('jsDelivr CDN failed, trying unpkg...');
      tryUnpkgFallback();
    };
    document.head.appendChild(pdfjsScript);
  }

  function tryUnpkgFallback() {
    const pdfjsScript = document.createElement('script');
    pdfjsScript.src = 'https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.min.js';
    pdfjsScript.onload = function() {
      if (initPDFJS('https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js')) {
        console.log('PDF.js loaded from unpkg CDN');
      } else {
        showError();
      }
    };
    pdfjsScript.onerror = function() {
      console.error('All CDNs failed to load PDF.js');
      showError();
    };
    document.head.appendChild(pdfjsScript);
  }

  function showError() {
    const logEl = document.getElementById('log');
    if (logEl) {
      logEl.textContent = 'Error: Failed to load PDF.js library. Check your internet connection and refresh the page.';
      logEl.style.color = '#f87171'; // red-400 (softer)
    }
  }

  // Load PDF.js from primary CDN
  const pdfjsScript = document.createElement('script');
  pdfjsScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js';
  pdfjsScript.onload = function() {
    if (!initPDFJS()) {
      console.error('PDF.js loaded but initialization failed');
      loadPDFJSFallback();
    }
  };
  pdfjsScript.onerror = function() {
    console.error('cdnjs CDN failed, trying fallback...');
    loadPDFJSFallback();
  };
  document.head.appendChild(pdfjsScript);
  </script>

  <script>
  // Initialize the rest when DOM is ready
  document.addEventListener('DOMContentLoaded', function() {

  const fileInput = document.getElementById('file');
  const drop = document.getElementById('dropzone');
  const dropLabel = document.getElementById('dropLabel');
  const startBtn = document.getElementById('start');
  const cancelBtn = document.getElementById('cancel');
  const qualityInput = document.getElementById('quality');
  const scaleInput = document.getElementById('scale');
  const bar = document.getElementById('bar');
  const stats = document.getElementById('stats');
  const log = document.getElementById('log');

  let currentFile = null;
  let controller = { cancelled:false };

  // No need for click listener - label automatically handles clicks on the input
  drop.addEventListener('dragover', e => { 
    e.preventDefault(); 
    drop.classList.add('border-teal-400', 'bg-teal-500/20', 'scale-105');
  });
  drop.addEventListener('dragleave', e => { 
    e.preventDefault(); 
    drop.classList.remove('border-teal-400', 'bg-teal-500/20', 'scale-105');
  });
  drop.addEventListener('drop', e => { 
    e.preventDefault(); 
    drop.classList.remove('border-teal-400', 'bg-teal-500/20', 'scale-105');
    const f = e.dataTransfer.files && e.dataTransfer.files[0]; 
    if(f) loadFile(f); 
  });
  fileInput.addEventListener('change', ()=> { if(fileInput.files && fileInput.files[0]) loadFile(fileInput.files[0]); });

  function loadFile(f){
    if(f.type !== 'application/pdf'){ 
      alert('Please select a PDF file'); 
      return; 
    }
    currentFile = f;
    drop.classList.add('border-blue-400', 'bg-blue-500/10');
    dropLabel.innerHTML = `<span class="text-blue-400 font-bold" style="color: #60a5fa;">‚úì</span> ${f.name}`;
    stats.textContent = `${(f.size/1024/1024).toFixed(2)} MB selected`;
    if (pdfjsReady) {
      log.innerHTML = '<span class="inline-block animate-bounce">‚ú®</span> <span>Ready to convert! Click the button below.</span>';
      log.style.color = '#60a5fa'; // blue-400
      startBtn.classList.add('animate-pulse-glow');
    } else {
      log.innerHTML = '<span class="inline-block animate-spin-slow">‚è≥</span> <span>Loading PDF.js library...</span>';
      log.style.color = '#94a3b8'; // slate-400
    }
  }

  startBtn.addEventListener('click', ()=> {
    if(!currentFile){ 
      alert('Choose a PDF first'); 
      return; 
    }
    if(!pdfjsReady || typeof pdfjsLib === 'undefined'){
      alert('PDF.js library is still loading. Please wait a moment and try again.');
      return;
    }
    controller.cancelled = false;
    cancelBtn.disabled = false;
    startBtn.disabled = true;
    startBtn.classList.remove('animate-pulse-glow');
    startBtn.classList.add('opacity-75', 'cursor-not-allowed');
    log.innerHTML = '<span class="inline-block animate-spin-slow">‚öôÔ∏è</span> <span>Starting conversion...</span>';
    log.style.color = '#60a5fa'; // blue-400
    processPDF(currentFile, { quality: parseFloat(qualityInput.value)||0.85, scale: parseFloat(scaleInput.value)||1.6 });
  });

  cancelBtn.addEventListener('click', ()=> { 
    if(controller.cancelled) return; // Prevent multiple clicks
    controller.cancelled = true; 
    log.innerHTML = '<span class="inline-block animate-pulse">‚è∏Ô∏è</span> <span>Cancelling... Please wait...</span>';
    log.style.color = '#fb923c'; // orange-400 (softer than red)
    cancelBtn.disabled = true;
    cancelBtn.textContent = 'Cancelling...';
  });

  async function processPDF(file, opts){
    try{
      const arr = await file.arrayBuffer();
      const loadingTask = pdfjsLib.getDocument({ data: arr });
      const pdf = await loadingTask.promise;
      const num = pdf.numPages;
      const zip = new JSZip();
      updateProgress(0);
      stats.textContent = `Pages: ${num} ‚Äî processing...`;
      // Get base filename for better naming
      const baseName = file.name.replace(/\.pdf$/i,'').replace(/[^a-z0-9]/gi, '_').substring(0, 50) || 'pdf';
      
      for(let i=1;i<=num;i++){
        if(controller.cancelled){ throw new Error('Cancelled by user'); }
        log.innerHTML = `<span class="inline-block animate-spin-slow">üîÑ</span> <span>Rendering page <strong>${i}</strong> of <strong>${num}</strong>...</span>`;
        log.style.color = '#60a5fa'; // blue-400
        const page = await pdf.getPage(i);
        
        if(controller.cancelled){ throw new Error('Cancelled by user'); }
        
        const viewport = page.getViewport({ scale: opts.scale });
        const canvas = document.createElement('canvas');
        canvas.width = Math.floor(viewport.width);
        canvas.height = Math.floor(viewport.height);
        const ctx = canvas.getContext('2d');
        
        // Clear canvas to ensure clean image
        ctx.fillStyle = '#FFFFFF';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        await page.render({ canvasContext: ctx, viewport: viewport }).promise;
        
        if(controller.cancelled){ throw new Error('Cancelled by user'); }
        
        // Create JPEG blob with explicit MIME type and quality
        const blob = await new Promise(res => {
          canvas.toBlob(res, 'image/jpeg', Math.max(0.1,Math.min(1,opts.quality)));
        });
        
        if(controller.cancelled){ throw new Error('Cancelled by user'); }
        
        // Validate blob before adding to ZIP
        if (!blob || blob.size === 0) {
          throw new Error(`Failed to create image for page ${i}`);
        }
        
        // Use descriptive filename and add to ZIP
        const fileName = `${baseName}_page_${String(i).padStart(3,'0')}.jpg`;
        zip.file(fileName, blob, { binary: true });
        updateProgress(Math.round((i/num)*100));
        
        if(controller.cancelled){ throw new Error('Cancelled by user'); }
        
        await new Promise(r => setTimeout(r, 50));
      }
      
      if(controller.cancelled){ throw new Error('Cancelled by user'); }
      
      log.innerHTML = '<span class="inline-block animate-spin-slow">üì¶</span> <span>Creating ZIP file...</span>';
      log.style.color = '#60a5fa'; // blue-400
      // Generate ZIP with standard compression
      let zipCancelled = false;
      const content = await zip.generateAsync({ 
        type:'blob',
        compression: 'DEFLATE',
        compressionOptions: { level: 6 }
      }, meta => { 
        if(controller.cancelled) {
          zipCancelled = true;
        }
        updateProgress(Math.round(meta.percent)); 
      });
      
      if(controller.cancelled || zipCancelled){ throw new Error('Cancelled by user'); }
      const zipName = baseName + '_images.zip';
      saveAs(content, zipName);
      log.innerHTML = `<span class="inline-block animate-bounce-in">üéâ</span> <span>Success! ZIP file downloaded with <strong>${num}</strong> JPG file(s).</span>`;
      log.style.color = '#34d399'; // emerald-400 (softer green)
      stats.textContent = `‚úì Finished: ${num} page(s) processed successfully`;
      updateProgress(100);
      startBtn.classList.remove('opacity-75', 'cursor-not-allowed');
      
      // Track conversion in GA4
      if (typeof trackConversion === 'function') {
        trackConversion(num);
      }
    } catch(err){
      console.error(err);
      if(err.message === 'Cancelled by user') {
        log.innerHTML = '<span class="inline-block">‚è∏Ô∏è</span> <span>Conversion cancelled by user</span>';
        log.style.color = '#fb923c'; // orange-400
        stats.textContent = 'Cancelled';
      } else {
        log.innerHTML = `<span class="inline-block">‚ùå</span> <span>Error: ${err.message || err}</span>`;
        log.style.color = '#f87171'; // red-400 (softer)
        stats.textContent = '‚úó Conversion failed';
      }
      updateProgress(0);
      startBtn.classList.remove('opacity-75', 'cursor-not-allowed');
    } finally {
      startBtn.disabled = false;
      cancelBtn.disabled = true;
      cancelBtn.textContent = 'Cancel'; // Reset button text
      controller.cancelled = false; // Reset cancellation flag
    }
  }

  function updateProgress(pct){ bar.style.width = Math.min(100,Math.max(0,pct)) + '%'; }
  }); // End of DOMContentLoaded event listener
  </script>
  
  <!-- Initialize Google AdSense -->
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    (adsbygoogle = window.adsbygoogle || []).push({});
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

</body>
</html>
